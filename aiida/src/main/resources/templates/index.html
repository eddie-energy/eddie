<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <link href="/img/icon.svg" rel="icon" type="image/svg+xml" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>AIIDA</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/cdn/themes/light.css"
    />
    <link rel="stylesheet" th:href="@{/css/index.css}" />
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/cdn/shoelace-autoloader.js"
    ></script>
  </head>
  <body>
    <div class="logout-position">
      <form method="post" th:action="@{/logout}">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <input class="logout-button" type="submit" value="Logout" />
      </form>
    </div>

    <h1>AIIDA</h1>

    <img alt="EDDIE Logo" height="64" th:src="@{/img/eddie.svg}" />

    <h2>Add new permission</h2>

    <form id="permission-form" class="permission-form" method="post">
      <input type="hidden" id="csrfToken" th:value="${_csrf.token}" />
      <input type="hidden" id="csrfHeader" th:value="${_csrf.headerName}" />
      <sl-input id="aiida-code" placeholder="AIIDA code" required></sl-input>
      <sl-button type="submit" variant="primary">Add</sl-button>
      <sl-button circle disabled>
        <sl-icon name="camera" label="Camera"></sl-icon>
      </sl-button>
    </form>

    <sl-dialog id="permission-dialog" label="Add permission">
      <div id="permission-dialog-content"></div>

      <sl-button id="permission-dialog-accept" slot="footer" variant="primary"
                 onclick="window.updatePermission('ACCEPT')" loading>
        Confirm
      </sl-button>

      <sl-button id="permission-dialog-reject" slot="footer" variant="danger"
                 onclick="window.updatePermission('REJECT')" loading>
        Reject
      </sl-button>

      <sl-button id="permission-dialog-close" slot="footer" outline onclick="window.hidePermissionDialog()" loading>
        Close
      </sl-button>
    </sl-dialog>

    <sl-dialog id="revoke-permission-dialog" label="Revoke permission">
      <sl-button slot="footer" variant="primary" id="revoke-permission-button">
        Revoke
      </sl-button>

      <p class="text">
        This action will revoke the given permission. The eligible party will no
        longer be able to receive data for this entry.
      </p>

      <sl-button slot="footer" outline onclick="window.hideRevokeDialog()">
        Cancel
      </sl-button>
    </sl-dialog>

    <h2>Active permissions</h2>
    <div id="active-permissions" class="permissions"></div>

    <h2>Expired permissions</h2>
    <div id="expired-permissions" class="permissions"></div>

    <script th:src="@{/js/main.js}" type="module"></script>
  </body>
</html>
