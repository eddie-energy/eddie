{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://eddie.energy/schemas/region-connectors/cds",
  "$defs": {
    "CDSMetadata": {
      "type": "object",
      "properties": {
        "cds_metadata_version": {
          "type": "string",
          "description": "The version of metadata object format this Server follows, which for this version of the specification is v1.\n"
        },
        "cds_metadata_url": {
          "type": "string",
          "format": "uri",
          "description": "A URL link to this metadata object’s canonical network location."
        },
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "When the metadata url was first made available."
        },
        "updated": {
          "type": "string",
          "format": "date-time",
          "description": "When this metadata object was last modified."
        },
        "name": {
          "type": "string",
          "description": "The name of the utility or entity (e.g. “Demo Gas & Electric”)."
        },
        "description": {
          "type": "string",
          "description": "A brief description about the utility or entity (e.g. “An electric and gas utility serving customers in Northern California”).\n"
        },
        "website": {
          "type": "string",
          "format": "uri",
          "description": "Where users can learn more about the utility or entity and its capabilities."
        },
        "documentation": {
          "type": "string",
          "format": "uri",
          "description": "Where Clients can find the utility or entity’s technical reference documentation."
        },
        "support": {
          "type": "string",
          "format": "uri",
          "description": "Where Clients can find contact information for technical support on the Server’s capabilities.\n"
        },
        "capabilities": {
          "description": "What capabilities and functionality this Server supports, which may be an empty array if the Server is not offering any additional capabilities beyond just this metadata object.\nIf the list of capabilities includes coverage, this array MUST also include a union of the capabilities listed in the Coverage Endpoint list of Coverage Entry objects’ capabilities values.\n",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "coverage": {
          "type": "string",
          "format": "uri",
          "description": "Where to find the Coverage Endpoint. This field is REQUIRED if coverage is listed in the capabilities array."
        },
        "related_metadata": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "description": "Where to find other related Metadata Endpoints."
        },
        "commodity_types": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "infrastructure_types": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "oauth_metadata": {
          "type": "string",
          "format": "uri",
          "description": "Endpoint for oauth metadata, only available if capabilities includes 'oauth'."
        }
      },
      "required": [
        "cds_metadata_version",
        "cds_metadata_url",
        "created",
        "updated",
        "name",
        "description",
        "website",
        "documentation",
        "support",
        "capabilities"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "capabilities": {
                "type": "array",
                "contains": {
                  "const": "coverage"
                }
              }
            }
          },
          "then": {
            "required": [
              "coverage"
            ]
          }
        },
        {
          "if": {
            "properties": {
              "capabilities": {
                "type": "array",
                "contains": {
                  "const": "oauth"
                }
              }
            }
          },
          "then": {
            "required": [
              "oauth_metadata"
            ]
          }
        }
      ]
    },
    "OAuthMetadata": {
      "type": "object",
      "properties": {
        "registration_endpoint": {
          "type": "string",
          "format": "uri",
          "description": "OAuth’s Dynamic Client Registration functionality is required to enable the Client Registration Process."
        },
        "scopes_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The scopes in this array MUST represent a union of all scope id values contained in the cds_scope_descriptions objects."
        },
        "service_documentation": {
          "type": "string",
          "format": "uri",
          "description": "Developer documentation is required by the Server to help streamline Client integration."
        },
        "op_policy_uri": {
          "type": "string",
          "format": "uri",
          "description": "Policies for Clients registering is required."
        },
        "op_tos_uri": {
          "type": "string",
          "format": "uri",
          "description": "Terms of use for Clients registering is required."
        },
        "revocation_endpoint": {
          "type": "string",
          "format": "uri",
          "description": "OAuth’s Token Revocation functionality is required."
        },
        "code_challenge_methods_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The code challenge methods in this array MUST represent a union of all code_challenge_methods_supported values contained in the cds_scope_descriptions objects."
        },
        "introspection_endpoint": {
          "type": "string",
          "format": "uri"
        }
      },
      "required": [
        "registration_endpoint",
        "scopes_supported",
        "service_documentation",
        "op_policy_uri",
        "op_tos_uri",
        "revocation_endpoint",
        "introspection_endpoint",
        "code_challenge_methods_supported",
        "token_endpoint"
      ],
      "allOf": [
        {
          "$ref": "#/$defs/OAuthCDSValues"
        },
        {
          "$ref": "#/$defs/OAuthExtensions"
        },
        {
          "$ref": "#/$defs/OAuthStandardValues"
        }
      ]
    },
    "OAuthExtensions": {
      "type": "object",
      "properties": {
        "authorization_details_types_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "OAuth’s Rich Authorization Requests functionality is required. This array of values MUST be the same as scopes_supported."
        },
        "pushed_authorization_request_endpoint": {
          "type": "string",
          "format": "uri",
          "description": "OAuth’s Pushed Authorization Requests functionality is required."
        }
      },
      "required": [
        "authorization_details_types_supported",
        "pushed_authorization_request_endpoint"
      ]
    },
    "OAuthStandardValues": {
      "properties": {
        "response_types_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The response types in this array MUST represent a union of all response_types_supported values contained in the cds_scope_descriptions objects."
        },
        "grant_types_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The response types in this array MUST represent a union of all grant_types_supported values contained in the cds_scope_descriptions objects."
        },
        "token_endpoint_auth_methods_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The response types in this array MUST represent a union of all token_endpoint_auth_methods_supported values contained in the cds_scope_descriptions object."
        }
      },
      "required": [
        "response_types_supported",
        "grant_types_supported",
        "token_endpoint_auth_methods_supported"
      ]
    },
    "OAuthCDSValues": {
      "type": "object",
      "properties": {
        "cds_oauth_version": {
          "type": "string",
          "description": "The version of the CDS-WG1-02 Client Registration specification that the Server has implemented, which for this version of the specification is v1"
        },
        "cds_human_registration": {
          "type": "string",
          "format": "uri",
          "description": "Where Clients who do not have the technical capacity to use the registration_endpoint can visit to manually register a Client using a user device"
        },
        "cds_test_accounts": {
          "type": "string",
          "format": "uri",
          "description": "Where Clients can find developer documentation on what test account credentials may be used for testing OAuth response_type=code authorization requests"
        },
        "cds_scope_descriptions": {
          "type": "object",
          "description": "An object providing additional information about what Scope values listed in scopes_supported mean. This object MUST include a key for each Scope listed in scopes_supported with a Scope Description as that key’s value.",
          "additionalProperties": {
            "$ref": "#/$defs/CdsScopeDescription"
          }
        },
        "cds_registration_fields": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/$defs/RegistrationField"
          },
          "description": "An object providing additional information about Registration Field that are referenced in Scope Description’s registration_requirements list. This object MUST include a key for each Registration Field id included in the registration_requirements lists in the metadata object with a Registration Field as that key’s value. If all registration_requirements lists are empty, this reference object is an empty object ({})."
        }
      },
      "required": [
        "cds_oauth_version",
        "cds_human_registration",
        "cds_test_accounts",
        "cds_scope_descriptions",
        "cds_registration_fields"
      ],
      "allOf": [
        {
          "$ref": "#/$defs/CdsOAuthMetadataAndClientRegistrationResponseEndpoints"
        }
      ]
    },
    "CdsScopeDescription": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique identifier of the scope. This MUST be the same value as the object key the Metadata Object’s cds_scope_descriptions object."
        },
        "name": {
          "type": "string",
          "description": "A human-readable name of the scope."
        },
        "description": {
          "type": "string",
          "description": "A human-readable description of what access or actions the scope will enable."
        },
        "documentation": {
          "type": "string",
          "format": "uri",
          "description": "Where developers can find documentation for the scope."
        },
        "registration_requirements": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "A list of any registration fields that MUST be submitted with Client Registration Requests or requirements that must be completed after registration before the scope is available to use in the Server’s production environment. All values in this array MUST be included in the Metadata Object’s cds_registration_fields object for a complete description of the requirement. If no additional requirements are needed, this value is an empty array ([])."
        },
        "registration_optional": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "A list of any registration fields that Clients MAY submit with the Client Registration Requests. If no additional fields are available, this value is an empty array ([])."
        },
        "response_types_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The OAuth response_type values that can be used with this scope. This value follows the same behavior as OAuth’s Metadata object response_types_supported, except that this value represents the response types supported for this individual scope and not all scopes for the Client. If a scope is not available for OAuth authorization requests (e.g. a client_credentials-only scope), this value is an empty array ([])."
        },
        "grant_types_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The OAuth grant type values that can be used with this scope. This value follows the same behavior as OAuth’s Metadata object grant_types_supported, except that this value represents the grant types supported for this individual scope and not all scopes for the Client. This array MUST contain at least one grant type."
        },
        "token_endpoint_auth_methods_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "The OAuth client authentication methods that can be used for granting tokens with this scope. This value follows the same behavior as OAuth’s Metadata object token_endpoint_auth_methods_supported, except that this value represents the client authentication methods supported for this individual scope and not all scopes for the Client. A value of \"none\" this array indicates that the scope may be used for public application without using a client secret."
        },
        "code_challenge_methods_supported": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "For scope descriptions where grant_types_supported includes the value authorization_code, OAuth’s Proof Key for Code Exchange by OAuth Public Clients functionality is required, and Servers MUST offer S256 and MUST NOT offer plain code verifier methods. For scope descriptions where grant_types_supported does not include authorization_code, no authorization request is performed, so no code challenge is required and this field value is and empty list ([])."
        },
        "authorization_details_fields": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/AuthorizationDetailsField"
          },
          "description": "A list of fields that MAY be included in Rich Authorization Requests the authorization details object for this scope type. If no extra authorization details fields are available, this value is an empty list ([])."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "documentation",
        "registration_requirements",
        "response_types_supported",
        "grant_types_supported",
        "token_endpoint_auth_methods_supported",
        "code_challenge_methods_supported",
        "authorization_details_fields"
      ]
    },
    "AuthorizationDetailsField": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique identifier of the authorization details field. This value is used as the key for the field when added to authorization_details data fields as part of OAuth’s Rich Authorization Requests."
        },
        "name": {
          "type": "string",
          "description": "A human-readable name of the authorization details field."
        },
        "description": {
          "type": "string",
          "description": "A human-readable description of what submitting values for this authorization details field means."
        },
        "documentation": {
          "type": "string",
          "format": "uri",
          "description": "Where developers can find more information about this authorization details field."
        },
        "format": {
          "type": "string",
          "anyOf": [
            {
              "type": "string",
              "const": "relative_or_absolute_date",
              "description": "A relative or absolute date string. Relative dates are formatted as defined by duration in RFC 3339 Appendix A. For example, P3Y represents a relative date range of 3 years. Absolute dates are formatted as date (YYYY-MM-DD). For example, 2024-01-02 represents the 2nd of January, 2024. Dates are defined as the date from the perspective of the Server’s local timezone."
            },
            {
              "type": "string",
              "const": "int",
              "description": "An integer value."
            },
            {
              "type": "string",
              "const": "decimal",
              "description": "A decimal value, which can have any number of significant units, but MUST NOT be stored or handled as a float value, in order to retain the precision of the value throughout Server and Client processing."
            }
          ],
          "description": "The data format that MUST be used in the value of the field when including it as a data field in authorization_details objects."
        },
        "default": {
          "description": "The default value that will be used in lieu of the Client submitting a value themselves. This is also the value that will be used if a basic OAuth scope string parameter is used instead of an authorization_details parameter."
        },
        "relative_date_limit": {
          "type": "integer",
          "description": "If format is relative_or_absolute_date, this is the largest relative date range that may be submitted. Servers MUST validate both submitted absolute dates and relative dates against the relative date limit, where when comparing to a submitted absolute date, the current Server date in the Server’s local timezone is used as the relative point of reference."
        },
        "absolute_date_limit": {
          "type": "integer",
          "description": "If format is relative_or_absolute_date, this is the furthest away date that may be submitted. Servers MUST validate both submitted absolute dates and relative dates against the absolute date limit, where when comparing to a submitted relative date, the current Server date in the Server’s local timezone is used as the relative point of reference."
        },
        "limit": {
          "type": "integer",
          "description": "If format is one of int or decimal, this is the largest value that can be the submitted."
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "documentation",
        "format",
        "default"
      ]
    },
    "RegistrationField": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique identifier of the registration field. This MUST be the same value as the object key the Metadata Object’s cds_registration_fields object."
        },
        "type": {
          "$ref": "#/$defs/RegistrationFieldType",
          "description": "What type of Registration Field this entry is."
        },
        "description": {
          "type": "string",
          "description": "A human-readable description of what should be submitted or expected for this registration field."
        },
        "documentation": {
          "type": "string",
          "format": "uri",
          "description": "Where developers can find more information about this registration field."
        },
        "field_name": {
          "type": "string",
          "description": "If type is registration_field, this is the name of the field to submit in the Client Registration Request and MUST start with cds_."
        },
        "format": {
          "description": "If type is registration_field, this is the data format that MUST be used in the value of the field.",
          "$ref": "#/$defs/RegistrationFieldFormat"
        },
        "default": {
          "description": "If type is registration_field and the field is optional, this is the default value that will be used in lieu of the Client submitting a value themselves. Including this default value in the object indicates the registration field is optional."
        },
        "max_length": {
          "type": "integer",
          "description": "If format is one of string, string_or_null, url, url_or_null, email, or email_or_null, this is the maximum length of the submitted value, if not null."
        },
        "max_size": {
          "type": "integer",
          "description": "If format is one of image, image_or_null, pdf, or pdf_or_null, this is the maximum file size of the submitted value before encoding into Base64, if not null."
        },
        "amount": {
          "type": "number",
          "description": "If type is payment_required, this is the amount in currency that will be required to complete registration."
        },
        "currency": {
          "type": "string",
          "description": "If type is payment_required, this is the monetary currency in ISO 4217 currency code."
        }
      },
      "required": [
        "id",
        "type",
        "description",
        "documentation"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {
                "enum": [
                  "payment_required"
                ]
              }
            }
          },
          "then": {
            "required": [
              "amount",
              "currency"
            ]
          }
        }
      ]
    },
    "RegistrationFieldType": {
      "type": "string",
      "description": "Registration Field types define which type of action the Client or Server will take for that registration field. Registration Fields can be either something that MUST or MAY be submitted as part of the Client Registration Request, depending on the submitted scope’s registration_requirements and registration_optional values, or can be something that a Client must do after registration in order to be full approved for use in the production environment.",
      "anyOf": [
        {
          "const": "registration_field",
          "description": "This field should be submitted with the Client Registration Request as the field_name. This type of registration field MUST also have field_name and format values. If this field is optional as part of registration, default must also be defined in the registration field object."
        },
        {
          "const": "manual_review",
          "description": "This field indicates that the Server will manually review the registration before approving it for production use. Notifications and communication about the status of this manual review will be conveyed using the Client Messages API."
        },
        {
          "const": "payment_required",
          "description": "This field indicates that a setup payment will be required before the Server will approve the Client for production use. Notifications and communication about how to pay and confirmation of payment will be conveyed using the Client Messages API."
        },
        {
          "const": "email_verification",
          "description": "This field indicates that the Client must verify their email before the Server will approve the Client for production use. Notifications and communication about how to verify the Client’s contact email will be conveyed using the Client Messages API."
        }
      ]
    },
    "RegistrationFieldFormat": {
      "type": "string",
      "description": "Registration Field formats define the data type of submitted values for these fields in Client Registration Requests.",
      "anyOf": [
        {
          "const": "string",
          "description": "If required, a string value MUST be submitted."
        },
        {
          "const": "string_or_null",
          "description": "Same as string, only with null being an additional possible value."
        },
        {
          "const": "url",
          "description": "If required, a URL value MUST be submitted"
        },
        {
          "const": "url_or_null",
          "description": "Same as url, only with null being an additional possible value."
        },
        {
          "const": "email",
          "description": "If required, a valid email address string MUST be submitted."
        },
        {
          "const": "email_or_null",
          "description": "Same as email, only with null being an additional possible value."
        },
        {
          "const": "boolean",
          "description": "If required, either true or false MUST be submitted."
        },
        {
          "const": "boolean_or_null",
          "description": "Same as boolean, only with null being an additional possible value."
        },
        {
          "const": "image",
          "description": "If required, a valid image file formatted as image/jpeg or image/png encoded as a string using Base64 MUST be submitted."
        },
        {
          "const": "image_or_null",
          "description": "Same as image, only with null being an additional possible value."
        },
        {
          "const": "pdf",
          "description": "If required, a valid pdf file formatted encoded using Base64 as a string MUST be submitted."
        },
        {
          "const": "pdf_or_null",
          "description": "Same as pdf, only with null being an additional possible value."
        }
      ]
    },
    "ClientRegistrationRequest": {
      "type": "object",
      "properties": {
        "client_name": {
          "type": "string"
        },
        "client_uri": {
          "type": "string",
          "format": "client_uri"
        },
        "logo_uri": {
          "type": "string",
          "format": "uri"
        },
        "tos_uri": {
          "type": "string",
          "format": "uri"
        },
        "policy_uri": {
          "type": "string",
          "format": "uri"
        },
        "contacts": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "description": "A space separated list containing all the scopes that should be available for the client.",
          "anyOf": [
            {
              "type": "string"
            },
            {
              "const": "cds_accounts_basic",
              "description": "Access to basic customer account information."
            },
            {
              "const": "cds_accounts_contacts",
              "description": "Access to the current contact information for a customer’s accounts."
            },
            {
              "const": "cds_accounts_detailed",
              "description": "Access to detailed information for a customer’s accounts."
            },
            {
              "const": "cds_servicecontracts_basic",
              "description": "Access to a customer’s list of service contracts (e.g. an electrical, natural gas, or water service) with some basic information about each service."
            },
            {
              "const": "cds_servicecontracts_suppliers",
              "description": "Access to the energy supplier or retailer information for a customer’s service contracts."
            },
            {
              "const": "cds_servicecontracts_detailed",
              "description": "Access to detailed service contract information for a customer’s services."
            },
            {
              "const": "cds_bill_amount_due",
              "description": "Access to the current amounts due for a customer’s accounts."
            },
            {
              "const": "cds_bill_statements_basic",
              "description": "Access to basic information about a customer’s bill statements."
            },
            {
              "const": "cds_bill_statements_detailed",
              "description": "Access to detailed information about a customer’s bill statements."
            },
            {
              "const": "cds_bill_statements_files",
              "description": "Access to the raw files (e.g. pdf bills) for a customer’s bill statements."
            },
            {
              "const": "cds_bill_sections_basic",
              "description": "Access to summary data of a customer’s bill sections."
            },
            {
              "const": "cds_bill_sections_detailed",
              "description": "Access to detailed data of a customer’s bill sections."
            },
            {
              "const": "cds_usage_basic",
              "description": "Access to basic usage data for a customer’s service contracts."
            },
            {
              "const": "cds_usage_detailed",
              "description": "Access to detailed usage data for a customer’s service contracts."
            },
            {
              "const": "cds_aggregation_inclusion",
              "description": "Approval for being included in an aggregation (e.g. whole-building benchmarking)."
            }
          ]
        },
        "redirect_uris": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "minItems": 1
        },
        "cds_initial_scope_of_use": {
          "type": "string"
        },
        "cds_autolist_in_directory": {
          "type": "boolean"
        }
      },
      "required": [
        "redirect_uris",
        "scope"
      ]
    },
    "ClientRegistrationResponse": {
      "description": "Modeled after Client Registration Response, see: https://www.rfc-editor.org/rfc/rfc7591#section-3.2.1",
      "type": "object",
      "properties": {
        "client_id": {
          "type": "string",
          "description": "OAuth 2.0 client identifier string.  It SHOULD NOT be currently valid for any other registered client, though an authorization server MAY issue the same client identifier to multiple instances of a registered client at its discretion."
        },
        "client_id_issued_at": {
          "type": "integer",
          "description": "Time at which the client identifier was issued.  The time is represented as the number of seconds from 1970-01-01T00:00:00Z as measured in UTC until the date/time of issuance."
        },
        "client_name": {
          "type": "string"
        },
        "client_secret": {
          "type": "string",
          "description": "A client_secret value MUST be present in the response and be limited to client_admin scope use only."
        },
        "client_secret_expires_at": {
          "type": "integer",
          "description": "REQUIRED if 'client_secret' is issued.  Time at which the client secret will expire or 0 if it will not expire.  The time is represented as the number of seconds from 1970-01-01T00:00:00Z as measured in UTC until the date/time of expiration."
        },
        "redirect_uris": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          }
        },
        "grant_types": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "response_types": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "scope": {
          "type": "string",
          "description": "Space separated list of scopes, must include 'client_admin'",
          "pattern": ".*client_admin.*"
        },
        "token_endpoint_auth_method": {
          "type": "string",
          "enum": [
            "client_secret_basic"
          ]
        },
        "cds_server_metadata": {
          "type": "string",
          "format": "uri",
          "description": "Where the Client can find their registration-specific version of the CDSC-WG1-01 Server Metadata. If the Client’s CDSC server metadata is no different from the public CDSC server metadata, Servers MAY simply link to the public URL. If this metadata endpoint requires authentication, Servers MUST authenticate Client requests to this endpoint via Bearer access token obtained using OAuth’s client_credentials grant with a scope of client_admin, and reject unauthenticated requests with a 401 Unauthorized response code. Clients know that they must use a Bearer token when Servers return a 401 response code for this endpoint when the Client makes an unauthenticated request to the endpoint."
        }
      },
      "required": [
        "client_id",
        "client_secret",
        "client_secret_expires_at",
        "scope",
        "token_endpoint_auth_method",
        "cds_server_metadata"
      ],
      "allOf": [
        {
          "$ref": "#/$defs/CdsOAuthMetadataAndClientRegistrationResponseEndpoints"
        },
        {
          "$ref": "#/$defs/ClientMetadataExtension"
        }
      ]
    },
    "CdsOAuthMetadataAndClientRegistrationResponseEndpoints": {
      "properties": {
        "cds_clients_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Clients API."
        },
        "cds_client_messages_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Clients Messages API."
        },
        "cds_scope_credentials_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Scope Credentials API."
        },
        "cds_grants_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Grants API."
        }
      },
      "required": [
        "cds_clients_api",
        "cds_client_messages_api",
        "cds_scope_credentials_api",
        "cds_grants_api"
      ]
    },
    "ClientMetadataExtension": {
      "type": "object",
      "description": "This specification extends CDSC-WG1-02 (Client Registration) to add the following named values to the Client Registration Response objects",
      "properties": {
        "cds_accounts_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Accounts API"
        },
        "cds_servicecontracts_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Service Contracts API"
        },
        "cds_servicepoints_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Service Points API"
        },
        "cds_meterdevices_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Meter Devices API"
        },
        "cds_billstatement_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Bill Statements API"
        },
        "cds_billsection_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Bill Sections API"
        },
        "cds_aggregations_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Aggregations API"
        },
        "cds_usagesegments_api": {
          "type": "string",
          "format": "uri",
          "description": "The base url for the Usage Segments API"
        }
      },
      "required": [
        "cds_accounts_api",
        "cds_servicecontracts_api",
        "cds_servicepoints_api",
        "cds_meterdevices_api",
        "cds_billstatement_api",
        "cds_billsection_api",
        "cds_aggregations_api",
        "cds_usagesegments_api"
      ]
    },
    "CoverageListing": {
      "allOf": [
        {
          "$ref": "#/$defs/Page"
        },
        {
          "properties": {
            "coverage_entries": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/CoverageEntry"
              }
            }
          },
          "required": [
            "coverage_entries"
          ]
        }
      ]
    },
    "CoverageEntry": {
      "type": "object",
      "description": "https://daniel-utilityapi.github.io/Connectivity/specs/cdsc-wg1-01/#coverage-entry-format",
      "properties": {
        "id": {
          "type": "string",
          "description": "A unique identifier for the coverage entry"
        },
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "When this coverage entry was first made available"
        },
        "updated": {
          "type": "string",
          "format": "date-time",
          "description": "When this coverage entry was last modified"
        },
        "entity_name": {
          "type": "string",
          "description": "A human readable name for the entity being covered (e.g. “Demo Gas & Electric”). The entity name in a coverage entry MAY be different than the Server metadata name value in situations where the Server is operated by a parent or other entity."
        },
        "entity_abbreviation": {
          "type": [
            "string",
            "null"
          ],
          "description": "The abbreviation for the entity being covered by the coverage entry (e.g. “DG&E”). This field is to assist Clients in parsing coverage for entities that are commonly known by their abbreviated names (e.g. “DG&E” rather than “Demo Gas & Electric”). If no abbreviation is available for the entity being covered, this value is null."
        },
        "name": {
          "type": "string",
          "description": "A human readable name for the coverage area or category (e.g. “Upstate New York electric territory”)."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the coverage area or category"
        },
        "type": {
          "type": "string",
          "enum": [
            "geographic",
            "logical"
          ],
          "description": "The type of coverage entry"
        },
        "role": {
          "type": "string",
          "enum": [
            "authoritative",
            "official",
            "aggregator"
          ],
          "description": "The role of the Server in offering capabilities for the coverage entry"
        },
        "infrastructure_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "distribution_utility",
              "metering_provider",
              "supplier",
              "generator",
              "market_operator",
              "distribution_service_operator",
              "transmission_service_operator",
              "service_provider"
            ]
          },
          "description": "A list of infrastructure categories applicable to the coverage entry"
        },
        "commodity_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "electricity",
              "natural_gas",
              "fuel_oil",
              "water",
              "wastewater",
              "trash",
              "distributed_energy"
            ]
          },
          "description": "A list of services or commodities applicable to the coverage entry"
        },
        "capabilities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "What capabilities and functionality this Server supports for the coverage entry"
        },
        "map_resource": {
          "type": "string",
          "format": "uri",
          "description": "Link to a map of the coverage territory"
        },
        "map_content_type": {
          "type": "string",
          "description": "Content-Type format of the map_resource"
        },
        "geojson_resource": {
          "type": "string",
          "format": "uri",
          "description": "Link to a GeoJSON object mapping the coverage territory"
        }
      },
      "required": [
        "id",
        "created",
        "updated",
        "entity_name",
        "entity_abbreviation",
        "name",
        "type",
        "role",
        "infrastructure_types",
        "commodity_types",
        "capabilities"
      ],
      "additionalProperties": false
    },
    "Accounts": {
      "description": "Clients may request to list Account objects that they have access to by making an HTTPS GET request, authenticated with a valid Bearer access_token that is scoped to provide access to a set of Accounts, to the cds_accounts_api URL included in the Client Registration Response or Clients API. The Account listing request responses are formatted as JSON objects and contain the following named values.",
      "allOf": [
        {
          "$ref": "#/$defs/Page"
        },
        {
          "properties": {
            "accounts": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/Account"
              }
            }
          },
          "required": [
            "accounts"
          ]
        }
      ]
    },
    "Account": {
      "type": "object",
      "properties": {
        "cds_account_id": {
          "type": "string",
          "description": "The Server’s unique identifier for this Account object."
        },
        "cds_created": {
          "type": "string",
          "format": "date-time",
          "description": "When the Server created this Account object."
        },
        "cds_modified": {
          "type": "string",
          "format": "date-time",
          "description": "When the Server last modified this Account object."
        },
        "cds_account_parent": {
          "type": [
            "string",
            "null"
          ],
          "description": "The cds_account_id of a parent Account object of which this Account is grouped under. If the Account is not a part of a parent grouping, this value is null."
        },
        "customer_number": {
          "type": [
            "string",
            "null"
          ],
          "description": "The identifier that a Customer has access to that identifies a collection of Accounts as being for the same Customer. If a Server only stores Accounts as the top-level identifier for Customers, or does not have a Customer-accessible identifier set for this Account, this value is null."
        },
        "account_number": {
          "type": "string",
          "description": "The number that a Customer sees on their bill and online user interface as the identifier for this Account."
        },
        "account_name": {
          "type": "string",
          "description": "The name that a Customer sees on their bill and online user interface as the name for this Account, if available."
        },
        "account_address": {
          "type": "string",
          "description": "The address that a Customer sees on their bill and online user interface as the address for this Account, if available."
        },
        "account_type": {
          "type": "string",
          "description": "What type of Account this is. (Replace with actual Account types)"
        },
        "account_contacts": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "description": "Type of contact"
              },
              "value": {
                "type": "string",
                "description": "Value of contact"
              }
            },
            "required": [
              "type",
              "value"
            ]
          },
          "description": "A list of Account Contacts for the Account."
        }
      },
      "required": [
        "cds_account_id",
        "cds_created",
        "cds_modified",
        "cds_account_parent",
        "customer_number",
        "account_number",
        "account_type",
        "account_contacts"
      ]
    },
    "UsageSegments": {
      "type": "object",
      "allOf": [
        {
          "properties": {
            "usage_segments": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/UsageSegment"
              }
            }
          },
          "required": [
            "usage_segments"
          ]
        },
        {
          "$ref": "#/$defs/Page"
        }
      ]
    },
    "UsageSegment": {
      "type": "object",
      "properties": {
        "cds_usagesegment_id": {
          "type": "string",
          "description": "The Server’s unique identifier for this Usage Segment object."
        },
        "cds_created": {
          "type": "string",
          "format": "date-time",
          "description": "When the Server created this Usage Segment object."
        },
        "cds_modified": {
          "type": "string",
          "format": "date-time",
          "description": "When the Server last modified this Usage Segment object."
        },
        "related_aggregations": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Aggregations to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Aggregation unique identifiers to which this Usage Segment is applicable."
        },
        "related_accounts": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Accounts to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Account unique identifiers to which this Usage Segment is applicable."
        },
        "related_servicecontracts": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Service Contracts to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Service Contract unique identifiers to which this Usage Segment is applicable."
        },
        "related_servicepoints": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Service Points to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Service Point unique identifiers to which this Usage Segment is applicable."
        },
        "related_meterdevices": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Meter Devices to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Meter Device unique identifiers to which this Usage Segment is applicable."
        },
        "related_billsections": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The unique identifiers for Bill Sections to which this Usage Segment is applicable."
          },
          "minItems": 1,
          "description": "The list of Bill Section unique identifiers to which this Usage Segment is applicable."
        },
        "segment_start": {
          "type": "string",
          "format": "date-time",
          "description": "The starting timestamp for the list of Usage Segment values."
        },
        "segment_end": {
          "type": "string",
          "format": "date-time",
          "description": "The ending timestamp for the list of Usage Segment values."
        },
        "interval": {
          "type": "number",
          "format": "decimal",
          "description": "How long between values, in seconds."
        },
        "format": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "The formats of the values, presented in the order in which the values are presented.",
            "enum": [
              "usage_kwh",
              "usage_fwd_kwh",
              "usage_rev_kwh",
              "usage_net_kwh",
              "aggregated_kwh",
              "demand_kw",
              "water_m3",
              "water_gal",
              "water_ft3",
              "gas_therm",
              "gas_ccf",
              "gas_mcf",
              "gas_mmbtu",
              "supply_mix",
              "eacs"
            ],
            "oneOf": [
              {
                "const": "usage_kwh",
                "description": "General Electric Usage in kWh object"
              },
              {
                "const": "usage_fwd_kwh",
                "description": "Forward Electric Usage in kWh object"
              },
              {
                "const": "usage_rev_kwh",
                "description": "Reverse Electric Usage in kWh object"
              },
              {
                "const": "usage_net_kwh",
                "description": "Net Electric Usage in kWh object"
              },
              {
                "const": "aggregated_kwh",
                "description": "Aggregated Electric Usage in kWh object"
              },
              {
                "const": "demand_kw",
                "description": "Electric Demand in kW object"
              },
              {
                "const": "water_m3",
                "description": "Water Usage in Cubic Meters object"
              },
              {
                "const": "water_gal",
                "description": "Water Usage in Gallons object"
              },
              {
                "const": "water_ft3",
                "description": "Water Usage in Cubic Feet object"
              },
              {
                "const": "gas_therm",
                "description": "Natural Gas Usage in Therms object"
              },
              {
                "const": "gas_ccf",
                "description": "Natural Gas Usage in CCF object"
              },
              {
                "const": "gas_mcf",
                "description": "Natural Gas Usage in MCF object"
              },
              {
                "const": "gas_mmbtu",
                "description": "Natural Gas Usage in mmBTU object"
              },
              {
                "const": "supply_mix",
                "description": "Electric Supply Mix object"
              },
              {
                "const": "eacs",
                "description": "Energy Attribute Certificates object"
              }
            ]
          },
          "minItems": 1,
          "description": "For each entry in values, these are the formats that are included."
        },
        "values": {
          "type": "array",
          "items": {
            "type": "array",
            "description": "A list of Value Sets representing the entries included in the Usage Segment.",
            "items": {
              "type": "object",
              "additionalProperties": {
                "type": "number",
                "description": "A value set"
              }
            }
          },
          "minItems": 1,
          "description": "A list of Value Sets that represent the entries included in the Usage Segment."
        }
      },
      "required": [
        "cds_usagesegment_id",
        "cds_created",
        "cds_modified",
        "related_aggregations",
        "related_accounts",
        "related_servicecontracts",
        "related_servicepoints",
        "related_meterdevices",
        "related_billsections",
        "segment_start",
        "segment_end",
        "interval",
        "format",
        "values"
      ]
    },
    "Page": {
      "type": "object",
      "properties": {
        "next": {
          "type": [
            "string",
            "null"
          ],
          "format": "uri",
          "description": "URL to the next page of results"
        },
        "previous": {
          "type": [
            "string",
            "null"
          ],
          "format": "uri",
          "description": "URL to the previous page of results"
        }
      },
      "additionalProperties": false
    }
  }
}